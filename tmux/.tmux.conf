# --- 기본 설정 ---
set -g prefix C-a
unbind C-b
bind C-a send-prefix

set -g mouse on
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on

# 설정 다시 로드 (Ctrl+a r)
bind r source-file ~/.tmux.conf \; display "Reloaded ~/.tmux.conf"

# 직관적인 분할 키 (| 와 - 는 반드시 따옴표로 감싸야 tmux가 파이프로 오해하지 않음)
bind "|" split-window -h -c "#{pane_current_path}"
bind "-" split-window -v -c "#{pane_current_path}"

# --- ★ 핵심: 중첩 Tmux 제어 (F12) ★ ---
# F12를 누르면 로컬 Tmux의 키 입력을 비활성화하여
# 안쪽(원격/도커) Tmux로 키를 전달합니다.
bind -T root F12  \
  set prefix None \;\
  set key-table off \;\
  set status-style "fg=colour245,bg=colour238" \;\
  if -F '#{pane_in_mode}' 'send-keys -X cancel' \;\
  refresh-client -S \;\

bind -T off F12 \
  set -u prefix \;\
  set -u key-table \;\
  set -u status-style \;\
  refresh-client -S

# --- 상태바 테마 (Tokyo Night Style) ---
set -g status-position bottom
set -g status-bg "colour235"
set -g status-fg "colour137"
set -g status-justify left

set -g status-left "#[fg=black,bg=blue,bold] #S #[default] "
set -g status-left-length 50

# 상태바 오른쪽: 모드 표시 (입력이 잠기면 회색으로 변함)
set -g status-right '#[fg=white,bg=red,bold]#{?client_prefix, COMMAND ,}#[fg=white,bg=colour240]#{?pane_in_mode, COPY ,}#[fg=black,bg=yellow,bold]#{?window_zoomed_flag, ZOOM ,} #[fg=white,bg=colour235] %H:%M '

setw -g window-status-current-format "#[fg=black,bg=green,bold] #I:#W #[default]"
setw -g window-status-format "#[fg=white,bg=colour235] #I:#W "